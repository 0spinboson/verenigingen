<!-- Email Template: Appeal Decision Notification -->
<!-- File: verenigingen/verenigingen/email_template/appeal_decision_notification.html -->

<div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <div style="background-color: {% if doc.appeal_decision == 'Upheld' %}#d4edda{% elif doc.appeal_decision == 'Partially Upheld' %}#fff3cd{% else %}#f8d7da{% endif %}; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <h2 style="color: {% if doc.appeal_decision == 'Upheld' %}#155724{% elif doc.appeal_decision == 'Partially Upheld' %}#856404{% else %}#721c24{% endif %}; margin: 0;">Appeal Decision: {{ doc.appeal_decision }}</h2>
        <p style="color: #6c757d; margin: 5px 0 0 0;">{{ frappe.utils.format_date(doc.decision_date, "dd MMMM yyyy") }}</p>
    </div>
    
    <div style="padding: 20px;">
        <p>Dear {{ doc.appellant_name }},</p>
        
        <p>A decision has been made regarding your appeal <strong>{{ doc.appeal_reference }}</strong>:</p>
        
        <div style="background-color: #f8f9fa; padding: 20px; border-radius: 5px; margin: 20px 0; border-left: 4px solid {% if doc.appeal_decision == 'Upheld' %}#28a745{% elif doc.appeal_decision == 'Partially Upheld' %}#ffc107{% else %}#dc3545{% endif %};">
            <h3 style="margin-top: 0;">
                {% if doc.appeal_decision == "Upheld" %}
                ✅ Appeal Upheld
                {% elif doc.appeal_decision == "Partially Upheld" %}
                ⚖️ Appeal Partially Upheld
                {% else %}
                ❌ Appeal Rejected
                {% endif %}
            </h3>
            
            {% if doc.appeal_decision == "Upheld" %}
            <p><strong>Your appeal has been upheld.</strong> The termination decision will be reversed and appropriate corrective actions will be taken.</p>
            {% elif doc.appeal_decision == "Partially Upheld" %}
            <p><strong>Your appeal has been partially upheld.</strong> Some aspects of your appeal have merit and modifications will be made to the original decision.</p>
            {% else %}
            <p><strong>Your appeal has been rejected.</strong> After careful review, the original termination decision has been determined to be appropriate and will stand.</p>
            {% endif %}
        </div>
        
        <div style="background-color: #e3f2fd; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #1976d2;">Appeal Summary</h3>
            <ul style="margin: 10px 0;">
                <li><strong>Member:</strong> {{ doc.member_name }}</li>
                <li><strong>Appeal Reference:</strong> {{ doc.appeal_reference }}</li>
                <li><strong>Decision:</strong> {{ doc.appeal_decision }}</li>
                <li><strong>Decision Date:</strong> {{ frappe.utils.format_date(doc.decision_date, "dd MMMM yyyy") }}</li>
                {% if doc.assigned_reviewer %}
                <li><strong>Reviewed By:</strong> {{ frappe.get_value("User", doc.assigned_reviewer, "full_name") or doc.assigned_reviewer }}</li>
                {% endif %}
            </ul>
        </div>
        
        {% if doc.decision_rationale %}
        <div style="margin: 20px 0;">
            <h3>Decision Rationale</h3>
            <div style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; border-left: 3px solid #6c757d;">
                {{ doc.decision_rationale | safe }}
            </div>
        </div>
        {% endif %}
        
        {% if doc.implementation_required %}
        <div style="background-color: #d1ecf1; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #17a2b8;">
            <h4 style="margin-top: 0; color: #0c5460;">Implementation Required</h4>
            <p style="margin-bottom: 0;">The decision requires implementation of corrective actions. These will be processed and you will be notified when complete.</p>
        </div>
        {% endif %}
        
        {% if doc.appeal_decision == "Rejected" %}
        <div style="background-color: #f8d7da; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #dc3545;">
            <h4 style="margin-top: 0; color: #721c24;">Next Steps</h4>
            <p>If you believe there are exceptional circumstances or new evidence that was not considered, you may contact our governance team. However, please note that appeal decisions are generally final.</p>
        </div>
        {% endif %}
        
        <p>If you have questions about this decision or the implementation process, please contact our governance team.</p>
        
        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
            <p>Best regards,<br>
            <strong>Governance Team</strong><br>
            {{ frappe.get_single("Verenigingen Settings").organization_name or "Organization" }}</p>
        </div>
    </div>
</div>
